import random

class TarotCard:
    def __init__(self, name, meaning, upright, reversed_meaning, suit=None, arcana="Major"):
        self.name = name
        self.meaning = meaning
        self.upright = upright
        self.reversed_meaning = reversed_meaning
        self.suit = suit
        self.arcana = arcana
        self.orientation = "正位" if random.random() > 0.5 else "逆位"
    
    def get_interpretation(self):
        if self.orientation == "正位":
            return self.upright
        return self.reversed_meaning
    
    def __str__(self):
        return f"{self.name} ({self.orientation})"

class TarotDeck:
    def __init__(self):
        self.cards = self.create_deck()
        self.shuffle()
    
    def create_deck(self):
        cards = []
        
        # 大阿卡纳牌
        major_arcana = [
            ("愚者", "新的开始、冒险", "新的旅程开始，充满潜力", "鲁莽、冒险失败", "Major"),
            ("魔术师", "创造力、意志力", "运用技能实现目标", "欺骗、操纵", "Major"),
            ("女祭司", "直觉、潜意识", "倾听直觉，内在智慧", "忽视直觉，压抑情感", "Major"),
            ("皇后", "丰饶、母性", "创造力，丰盛富足", "依赖，过度保护", "Major"),
            ("皇帝", "权威、结构", "领导力，建立秩序", "控制欲强，僵化", "Major"),
            ("教皇", "传统、精神指导", "寻求智慧，精神指引", "教条主义，盲从", "Major"),
            ("恋人", "爱情、选择", "和谐关系，重要选择", "不和谐，错误选择", "Major"),
            ("战车", "意志力、胜利", "克服障碍，取得成功", "失去方向，冲突", "Major"),
            ("力量", "勇气、耐心", "内在力量，克服挑战", "自我怀疑，无力感", "Major"),
            ("隐士", "内省、寻求真理", "自我反思，寻找答案", "孤独，逃避现实", "Major"),
            ("命运之轮", "命运、转折点", "积极变化，命运转折", "消极变化，抗拒改变", "Major"),
            ("正义", "公正、真理", "公平决定，承担责任", "不公正，逃避责任", "Major"),
            ("倒吊人", "牺牲、新视角", "换位思考，接受现状", "拖延，无谓牺牲", "Major"),
            ("死神", "结束、转变", "结束与新生，转变", "抗拒改变，停滞不前", "Major"),
            ("节制", "平衡、调和", "平衡和谐，自我控制", "失衡，极端行为", "Major"),
            ("恶魔", "束缚、物质主义", "物质束缚，欲望控制", "摆脱束缚，精神解放", "Major"),
            ("塔", "剧变、启示", "重大变化，突破束缚", "避免灾难，小挫折", "Major"),
            ("星星", "希望、灵感", "希望重生，精神觉醒", "失去希望，悲观", "Major"),
            ("月亮", "幻觉、潜意识", "面对恐惧，探索潜意识", "困惑，自我欺骗", "Major"),
            ("太阳", "快乐、成功", "成功快乐，积极能量", "暂时挫折，小成功", "Major"),
            ("审判", "重生、内在召唤", "自我觉醒，新的开始", "自我怀疑，错失机会", "Major"),
            ("世界", "完成、成就", "圆满成功，成就达成", "未完成，需要努力", "Major")
        ]
        
        for name, meaning, upright, reversed_meaning, arcana in major_arcana:
            cards.append(TarotCard(name, meaning, upright, reversed_meaning, arcana=arcana))
        
        # 小阿卡纳牌 - 权杖
        wands = [
            ("权杖一", "新行动、创造力", "新计划开始，充满能量", "延迟，缺乏方向", "权杖"),
            ("权杖二", "规划、决策", "未来规划，做出决定", "恐惧改变，犹豫不决", "权杖"),
            ("权杖三", "远见、合作", "展望未来，团队合作", "缺乏远见，独自奋斗", "权杖"),
            ("权杖四", "庆祝、稳定", "庆祝成就，稳定和谐", "不稳定，小问题", "权杖"),
            ("权杖五", "冲突、竞争", "健康竞争，解决冲突", "避免冲突，内部斗争", "权杖"),
            ("权杖六", "胜利、认可", "获得认可，成功在望", "挫折，缺乏认可", "权杖"),
            ("权杖七", "挑战、坚持", "面对挑战，坚持立场", "不堪重负，放弃", "权杖"),
            ("权杖八", "快速行动、进展", "快速进展，消息传来", "延迟，计划混乱", "权杖"),
            ("权杖九", "毅力、警惕", "坚持到底，保持警惕", "偏执，过度防御", "权杖"),
            ("权杖十", "负担、责任", "责任过重，需要帮助", "放下负担，委派任务", "权杖"),
        ]
        
        # 小阿卡纳牌 - 圣杯
        cups = [
            ("圣杯一", "爱、情感", "新的情感开始，爱与和谐", "情感混乱，失望", "圣杯"),
            ("圣杯二", "和谐、伙伴关系", "和谐关系，平等合作", "不平衡，沟通问题", "圣杯"),
            ("圣杯三", "庆祝、友谊", "庆祝成就，朋友相聚", "过度享乐，表面关系", "圣杯"),
            ("圣杯四", "沉思、不满", "自我反思，评估选择", "错失机会，过度消极", "圣杯"),
            ("圣杯五", "失落、悲伤", "接受失落，寻找希望", "沉溺悲伤，忽视积极", "圣杯"),
            ("圣杯六", "回忆、童年", "美好回忆，怀旧之情", "活在回忆，逃避现实", "圣杯"),
            ("圣杯七", "选择、幻想", "明确目标，做出选择", "困惑，不切实际", "圣杯"),
            ("圣杯八", "离开、寻找", "寻求更深意义，离开舒适区", "恐惧改变，安于现状", "圣杯"),
            ("圣杯九", "满足、愿望成真", "愿望实现，自我满足", "物质满足，精神空虚", "圣杯"),
            ("圣杯十", "和谐、家庭", "家庭和谐，情感满足", "家庭冲突，不和谐", "圣杯"),
        ]
        
        # 小阿卡纳牌 - 宝剑
        swords = [
            ("宝剑一", "新想法、突破", "思想清晰，突破困境", "混乱想法，负面思维", "宝剑"),
            ("宝剑二", "僵局、逃避", "做出决定，面对现实", "逃避现实，拒绝选择", "宝剑"),
            ("宝剑三", "心痛、悲伤", "接受痛苦，开始疗愈", "深陷痛苦，无法释怀", "宝剑"),
            ("宝剑四", "休息、恢复", "充分休息，恢复能量", "过度休息，逃避问题", "宝剑"),
            ("宝剑五", "冲突、胜利", "短期胜利，吸取教训", "不惜代价取胜，后悔", "宝剑"),
            ("宝剑六", "过渡、疗愈", "逐渐恢复，向前迈进", "停滞不前，无法释怀", "宝剑"),
            ("宝剑七", "欺骗、策略", "巧妙策略，避免冲突", "欺骗，不诚实行为", "宝剑"),
            ("宝剑八", "限制、无助", "发现出路，重获自由", "感觉被困，自我设限", "宝剑"),
            ("宝剑九", "焦虑、恐惧", "面对恐惧，寻求帮助", "过度焦虑，噩梦困扰", "宝剑"),
            ("宝剑十", "结束、新生", "困难结束，新的开始", "暂时挫折，需要坚持", "宝剑"),
        ]
        
        # 小阿卡纳牌 - 星币
        pentacles = [
            ("星币一", "新机会、财富", "新机会出现，财务稳定", "错失机会，财务不稳", "星币"),
            ("星币二", "平衡、适应", "灵活适应，平衡生活", "失衡，财务压力", "星币"),
            ("星币三", "团队合作、技能", "团队合作，技能发展", "缺乏合作，技能不足", "星币"),
            ("星币四", "保守、控制", "财务稳定，保护资源", "过度控制，吝啬", "星币"),
            ("星币五", "困难、贫困", "互相支持，共度难关", "孤立无援，财务危机", "星币"),
            ("星币六", "慷慨、分享", "慷慨分享，公平交易", "自私，不公平交易", "星币"),
            ("星币七", "评估、耐心", "评估进展，耐心等待", "缺乏耐心，投资失误", "星币"),
            ("星币八", "技艺、专注", "专注工作，技能提升", "缺乏动力，工作马虎", "星币"),
            ("星币九", "独立、享受", "享受成果，独立自主", "过度独立，物质主义", "星币"),
            ("星币十", "财富、家庭", "家庭富足，财务安全", "家庭冲突，财务问题", "星币"),
        ]
        
        # 添加小阿卡纳牌
        for suit_cards, suit_name in zip([wands, cups, swords, pentacles], ["权杖", "圣杯", "宝剑", "星币"]):
            for name, meaning, upright, reversed_meaning, _ in suit_cards:
                cards.append(TarotCard(name, meaning, upright, reversed_meaning, suit=suit_name, arcana="Minor"))
        
        return cards
    
    def shuffle(self):
        random.shuffle(self.cards)
    
    def draw(self, num_cards):
        if num_cards > len(self.cards):
            num_cards = len(self.cards)
        return [self.cards.pop() for _ in range(num_cards)]